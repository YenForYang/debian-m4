<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- 
This manual (31 December 2016) is for GNU M4 (version
1.4.18), a package containing an implementation of the m4 macro
language.

Copyright (C) 1989-1994, 2004-2014, 2016 Free Software
Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License,
Version 1.3 or any later version published by the Free Software
Foundation; with no Invariant Sections, no Front-Cover Texts, and no
Back-Cover Texts.  A copy of the license is included in the section
entitled "GNU Free Documentation License." -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Diversions (GNU M4 1.4.18 macro processor)</title>

<meta name="description" content="Diversions (GNU M4 1.4.18 macro processor)">
<meta name="keywords" content="Diversions (GNU M4 1.4.18 macro processor)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Indices.html#Indices" rel="index" title="Indices">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="index.html#Top" rel="up" title="Top">
<link href="Divert.html#Divert" rel="next" title="Divert">
<link href="Search-Path.html#Search-Path" rel="prev" title="Search Path">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="Diversions"></a>
<div class="header">
<p>
Next: <a href="Text-handling.html#Text-handling" accesskey="n" rel="next">Text handling</a>, Previous: <a href="File-Inclusion.html#File-Inclusion" accesskey="p" rel="prev">File Inclusion</a>, Up: <a href="index.html#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Indices.html#Indices" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Diverting-and-undiverting-output"></a>
<h2 class="chapter">10 Diverting and undiverting output</h2>

<a name="index-deferring-output"></a>
<p>Diversions are a way of temporarily saving output.  The output of
<code>m4</code> can at any time be diverted to a temporary file, and be
reinserted into the output stream, <em>undiverted</em>, again at a later
time.
</p>
<a name="index-TMPDIR"></a>
<p>Numbered diversions are counted from 0 upwards, diversion number 0
being the normal output stream.  GNU
<code>m4</code> tries to keep diversions in memory.  However, there is a
limit to the overall memory usable by all diversions taken together
(512K, currently).  When this maximum is about to be exceeded,
a temporary file is opened to receive the contents of the biggest
diversion still in memory, freeing this memory for other diversions.
When creating the temporary file, <code>m4</code> honors the value of the
environment variable <code>TMPDIR</code>, and falls back to <samp>/tmp</samp>.
Thus, the amount of available disk space provides the only real limit on
the number and aggregate size of diversions.
</p>

<p>Diversions make it possible to generate output in a different order than
the input was read.  It is possible to implement topological sorting
dependencies.  For example, GNU Autoconf makes use of
diversions under the hood to ensure that the expansion of a prerequisite
macro appears in the output prior to the expansion of a dependent macro,
regardless of which order the two macros were invoked in the user&rsquo;s
input file.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="Divert.html#Divert" accesskey="1">Divert</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diverting output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="Undivert.html#Undivert" accesskey="2">Undivert</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Undiverting output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="Divnum.html#Divnum" accesskey="3">Divnum</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diversion numbers
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="Cleardivert.html#Cleardivert" accesskey="4">Cleardivert</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Discarding diverted text
</td></tr>
</table>

<hr>
<div class="header">
<p>
Next: <a href="Text-handling.html#Text-handling" accesskey="n" rel="next">Text handling</a>, Previous: <a href="File-Inclusion.html#File-Inclusion" accesskey="p" rel="prev">File Inclusion</a>, Up: <a href="index.html#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Indices.html#Indices" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
